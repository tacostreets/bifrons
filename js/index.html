<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wizard's Adventures</title>
    <script>
        function main() {
            form = document.getElementById("wizard-form");
            form.addEventListener("submit", task);
            updateLocationText();
        }

        function task(evt) {
            evt.preventDefault();
            text = document.getElementById("task").value;
            if (text == "study"){
                // do study action
                wizSkill = getSkill();
                wizSkill = wizSkill + 1;
                setSkill(wizSkill);
                updateSkillText();
            } else if (text == "reset") {
                resetWizard();
                updateSkillText();
                updateLocationText();
            } else {
                setLocation(text);
                updateLocationText();
            }
        }

        function updateLocationText() { // creates variable and updates web page text
            wizLocation = getLocation();//created wizLocation variable
            p = document.getElementById("location");
            if (wizLocation == "tower"){
                p.innerHTML = "You travel to your modest one-story wizard tower.";
            } else if (wizLocation == "village") {
                p.innerHTML = "You travel to the village 100 yds upwind from your tower.";
            } else if (wizLocation == "forest") {
                p.innerHTML = "You head out into the forest behind your tower.";
            } else {
                p.innerHTML = "I don't know where " + wizLocation + " is.";
            }

        }

        function setLocation(wizLocation) { //sets & stores location
            // local storage set here and can be changed inside this function later
            // location progress is set here locally 
            localStorage.setItem("wizLocation", wizLocation);
        }
        
        function getLocation() { //gets location from storage
            // retrieves the location from entry in the localStorage
            wizLocation = localStorage.getItem("wizLocation");
            if (wizLocation === null) {
                setLocation("tower");
            }
            return localStorage.getItem("wizLocation");  
        }
        
        function setSkill(wizSkill) { //sets & stores skill
            // sets and stores the skill aquired in the process of playing the game
            localStorage.setItem("wizSkill", wizSkill);
        }
        
        function getSkill() { //gets skill level
            // retrieves the skill level from localStorage or sets to 0 if there is no history
            wizSkill = localStorage.getItem("wizSkill");
            if (wizSkill === null) {
                setSkill(0);
            }
            wizSkill = localStorage.getItem("wizSkill");
            wizSkill = parseInt(wizSkill);
            return wizSkill;
        }

        function updateSkillText() {// creates variable and updates web page text
            wizSkill = getSkill();

            p = document.getElementById("skill");
            p.innerHTML = "What a good student! Current skill level is " + wizSkill + ".";  
                
        }

        function resetWizard() {
            localStorage.clear();
        }

    </script>

</head>

<body onload="main()">
    <form id="wizard-form" action="index.html" method="GET">
        <label for="task">What would you like to do?</label>
        <input id="task" type="text" name="task" />
        <input type="submit" value="Do My Bidding" />   
    </form>
    <hr/>
    <p id="location"></p>
    <p id="skill"></p>
</body>

</html>
